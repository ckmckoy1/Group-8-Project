<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shipping Management | Wild Path Outfitters</title>
    <!-- Link to your custom CSS -->
    <link rel="stylesheet" href="../css/settleShipmentStyle.css">
</head>
<body>
    <header class="header">
        <h1>WPO Shipping Management System</h1>
    </header>

    <main>
        <div class="settle-shipment-container">
            <h2>Order Shipping Settlement</h2>
            <h3>
                Click the "Scan" button to scan the barcode or enter the Order ID to pull the order.
                Then enter the Final Amount and click the "Settle Shipment" button to settle the order.
            </h3>
            <form id="settleShipmentForm">
                <div class="form-group">
                    <h3>Step 1: Scan Barcode or Enter Order ID</h3>
                    <small class="info-text"></small>
                    <div class="order-id-container">
                        <button type="button" id="barcodeScanner" class="action-button" aria-label="Scan Barcode">
                            <img src="../assets/barcode-scanner.svg" alt="Scan Barcode Icon" width="24" height="24" class="icon"> Scan
                        </button>
                        <span class="or-text">or</span>
                        <span class="order-id-prefix">WP-</span>
                        <input type="text" id="orderId" name="orderId" placeholder="Enter Order Number" required>
                    </div>
                    <p id="scannerInstructions" class="scanner-instructions" style="display: none;">
                        Please align the barcode within the frame to scan. Ensure good lighting and hold the camera steady.
                    </p>
                    <div id="loadingSpinner" class="loading-spinner" style="display: none;">
                        <img src="../assets/loading-spinner.gif" alt="Loading..." width="50" height="50">
                        <p>Initializing camera...</p>
                    </div>
                    <!-- Html5Qrcode Scanner Container -->
                    <div id="qr-reader" style="width: 100%; max-width: 600px; display: none;"></div>
                    <!-- Fallback Manual Entry -->
                    <p>If you are unable to scan the barcode, please enter the Order ID manually.</p>
                </div>

                <!-- Order History Section -->
                <div class="order-history-container" style="display: none;">
                    <h2>Order History</h2>
                    <table class="order-history-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Approval Date</th>
                                <th>Status</th>
                                <th>Tracking Link</th>
                            </tr>
                        </thead>
                        <tbody id="orderHistoryTableBody">
                            <!-- Order history will be populated here -->
                        </tbody>
                    </table>
                </div>

                <!-- Warehouse Status Display -->
                <div class="warehouse-status-container" style="display: none;">
                    <h2>Warehouse Status</h2>
                    <p id="warehouseStatus">Loading status...</p>
                </div>

                <div class="form-group">
                    <h3>Step 2: Enter Final Amount</h3>
                    <input type="number" id="finalAmount" name="finalAmount" placeholder="Final Amount" required step="0.01" min="0">
                </div>
                
                <h3>Step 3: Click Settle Shipment Button</h3>
                <button type="submit" class="submit-button">Settle Shipment</button>

                <div id="message" class="message" style="display: none;"></div>
            </form>
            
            <!-- Print after approval -->
            <button id="printLabel" style="display:none;">Print Shipment Label</button>
        </div>
    </main>

    <!-- Include jsPDF Library (if needed for PDF generation) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Include the bundled JavaScript file -->
    <script src="../js/bundle.js"></script>
</body>
</html>
